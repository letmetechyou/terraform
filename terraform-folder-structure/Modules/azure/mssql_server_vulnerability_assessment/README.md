# MSSQL_SERVER_VULNERABILITY_ASSESSMENT VALUES EXAMPLE
mssql_server_vulnerability_assessment_data = {
  vulnerability_assessment1 = {
    enabled                      = true
    server_security_alert_policy_id = "your-server-security-alert-policy-id"
    storage_container_path          = "your-storage-container-path"
    storage_account_access_key      = "your-storage-account-access-key"
    storage_container_sas_key       = "your-storage-container-sas-key"

    recurring_scans = [
      {
        emails                    = ["admin1@example.com", "admin2@example.com"]
        email_subscription_admins = true
        enabled                   = true
      },
      # Add additional recurring scans if needed
    ]
  }
}

# MSSQL_SERVER_VULNERABILITY_ASSESSMENT MODULE REFERENCE
module "mssql_server_vulnerability_assessment" {
        source = "./Modules/mssql_server_vulnerability_assessment"

        mssql_server_vulnerability_assessment_data = var.mssql_server_vulnerability_assessment_data
}

# MSSQL_SERVER_VULNERABILITY_ASSESSMENT VARIABLE
variable "mssql_server_vulnerability_assessment_data" {
  type = map(object({
    enabled                      = bool
    server_security_alert_policy_id = string
    storage_container_path          = string
    storage_account_access_key      = string
    storage_container_sas_key       = string

    recurring_scans = list(object({
      emails                    = list(string)
      email_subscription_admins = bool
      enabled                   = bool
    }))
  }))
}
